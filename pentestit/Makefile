
HOST:=http://site.test.lab
DISCOVERY:="https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/common.txt"

help: ## Show available targets
	@cat Makefile* | grep -E '^[a-zA-Z_-]+:.*?## .*$$' | sort | awk 'BEGIN {FS = ":.*?## "}; {printf "\033[36m%-30s\033[0m %s\n", $$1, $$2}'

vpn_start: ## Setup Open VPN
	@bin/openvpn.start.sh

vpn_test: ## Tets Open VPN
	@bin/openvpn.test.sh

run_nc: ## Ncat to run HOST= PORT= make run_nc
	@bin/run.nc.sh

wpscan_vplugin: ## Scan Wordpress vulnerable plugins
	@bin/run.wpscan.sh "--url $(HOST) --enumerate vp --random-user-agent"

wpscan_users: ## Scan Wordpress users vulnerabilbies
	@bin/run.wpscan.sh "--url $(HOST) --enumerate u --random-user-agent"

wpscan_version: ## Scan Wordpress version
	@bin/run.wpscan.sh "--url $(HOST) --random-user-agent"

wpscan_all: ## Scan Wordpress all vulnerabilities
	@bin/run.wpscan.sh "--url $(HOST) -e at -e ap -e u --random-user-agent"

metasploit: ## Run Metasploit framework
	@echo "Run Metasploit"
	docker run -it --rm metasploitframework/metasploit-framework

mst_dbstart: ## Run Metasploit framework with Database
	@echo "Run Metasploit"
	@docker-compose -f metasploit/docker-compose.yml up -d
	@docker-compose -f metasploit/docker-compose.yml run -p 8880:8880 ms

mst_dbstop: ## Stop Metasploit framework and database
	@echo "Stop Metasploit"
	@docker-compose -f metasploit/docker-compose.yml down

dirb: ## Run Dirb against url
	docker run --rm hypnza/dirbuster -u $(HOST)

dirbpy: ## Run Dirbpy against url
	@echo  "Run dirbpy framework"
	docker run --rm marcolivierbouch/dirbpy dirbpy -u $(HOST) -o $(DISCOVERY) -p "192.168.101.12:8080"

sqlmap: ## Run SQL Map
	@echo  "Run sql map"
	docker run --rm jdecool/sqlmap -u "$(HOST)/wp-admin/admin-ajax.php?action=ajax_survey&sspcmd=save&survey_id=3556498" -p survey_id --dbms=mysql