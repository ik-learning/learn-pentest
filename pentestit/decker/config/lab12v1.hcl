// environment variable config
// https://www.offensive-security.com/metasploit-unleashed/scanner-dcerpc-auxiliary-modules/
variable "target_host" {
  type    = "string"
  default = "pentestv12.com"
}

resource "nmap" "nmap_192_168_101_12" {
  host           = "192.168.101.12"
  plugin_enabled = "true"
}

// SMTP scans
resource "metasploit" "smtp_enum" {
  exploit = "auxiliary/scanner/smtp/smtp_enum"
  options = {
    RHOSTS = "192.168.101.12"
  }
  plugin_enabled = "true"
}

// IMAP scans
resource "metasploit" "imap_version" {
  exploit = "auxiliary/scanner/imap/imap_version"
  options = {
    RHOSTS = "192.168.101.12"
  }
  plugin_enabled = "true"
}

// IMAP scans
resource "metasploit" "portscan" {
  exploit = "auxiliary/scanner/portscan/tcp"
  options = {
    RHOSTS = "192.168.101.12"
    INTERFACE = "eth0"
    THREADS = "4"
  }
  plugin_enabled = "true"
}

resource "metasploit" "portscan_smb" {
  exploit = "auxiliary/scanner/smb/smb_version"
  options = {
    RHOSTS = "192.168.101.12"
    THREADS = "4"
  }
  plugin_enabled = "true"
}

resource "metasploit" "portscan_robots" {
  exploit = "auxiliary/scanner/http/robots_txt"
  options = {
    RHOSTS = "192.168.101.12"
    THREADS = "4"
  }
  plugin_enabled = "true"
}

resource "metasploit" "http_options" {
  exploit = "auxiliary/scanner/http/options"
  options = {
    RHOSTS = "192.168.101.12"
    THREADS = "4"
  }
  plugin_enabled = "true"
}


resource "metasploit" "imap_uw" {
  exploit = "exploit/linux/imap/imap_uw_lsub"
  options = {
    RHOSTS = "192.168.101.12"
    THREADS = "4"
  }
  plugin_enabled = "true"
}

resource "metasploit" "telnet_login" {
  exploit = "auxiliary/scanner/telnet/telnet_login"
  options = {
    RHOSTS = "192.168.101.12"
    THREADS = "4"
  }
  plugin_enabled = "true"
}

resource "metasploit" "udp_sweep" {
  exploit = "auxiliary/scanner/discovery/udp_sweep"
  options = {
    RHOSTS = "192.168.101.12"
    THREADS = "4"
  }
  plugin_enabled = "true"
}

resource "metasploit" "endpoint_mapper" {
  exploit = "auxiliary/scanner/dcerpc/endpoint_mapper"
  options = {
    RHOSTS = "192.168.101.12"
    THREADS = "20"
  }
  plugin_enabled = "true"
}


resource "metasploit" "endpoint_hidden" {
  exploit = "auxiliary/scanner/dcerpc/hidden"
  options = {
    RHOSTS = "192.168.101.12"
    THREADS = "20"
  }
  plugin_enabled = "true"
}





