#!/usr/bin/python3
# https://medium.com/@valesteve91/vulnhub-write-up-five86-1-3deb7aa513cb
import passlib.hash
import threading
from time import sleep

salt = '9fgG/hiM'
psw = '$apr1$9fgG/hiM$BtsL9qpNHUlylaLxk81qY1'
count = 0
done = True


def progress(total):
    global count
    while done:
        print('{} OUT of {}'.format(count, total))
        sleep(10)


def testP(w):
    stripped = w.strip()
    result = passlib.hash.apr_md5_crypt.encrypt(stripped, salt=salt)
    if result == psw:
        print('the pass is: {}'.format(stripped))


with open('list.txt') as f:
    lines = f.readlines()
    interval = threading.Thread(target=progress, args=(len(lines),))
    interval.start()
for line in lines:
    count += 1
    t = threading.Thread(target=testP, args=(line,))
    t.start()
    
f.close()
global done
done = False
